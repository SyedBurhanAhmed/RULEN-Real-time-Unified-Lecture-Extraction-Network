{% extends "base.html" %}
{% block title %}Summarized Notes{% endblock %}

{% block content %}

<hr class="my-6 border-neutral-800">

<h3 class="text-lg font-semibold mb-3 text-white">ğŸ“¥ Download Generated Notes</h3>
<a href="{{ docx_link }}"
   class="bg-gradient-to-r from-neutral-700 to-neutral-800 hover:from-neutral-600 hover:to-neutral-700 text-white px-6 py-2 rounded-md shadow transition inline-block mb-6"
   download>
    â¬‡ï¸ Download Notes (.docx)
</a>

{% if show_notes %}
  <h2 class="text-2xl font-semibold mb-4 text-white">ğŸ“ Summarized Lecture Notes</h2>
  <p class="text-neutral-300 mb-4"><strong>ğŸ“Œ Detected Language:</strong> {{ result.language }}</p>

  {% if result.converted_text %}
    <h3 class="text-lg font-medium mb-2 text-white">ğŸ“œ Roman Urdu / Converted Text:</h3>
    <div class="bg-neutral-900 p-4 rounded-md shadow border border-neutral-800 mb-6 text-neutral-200 max-h-[300px] overflow-y-auto">
      {{ result.converted_text | safe }}
    </div>
  {% endif %}

  <h3 class="text-lg font-medium mb-2 text-white">ğŸ“ Notes in Local Language:</h3>
  <div class="bg-neutral-900 p-4 rounded-md shadow border border-neutral-800 mb-6 text-neutral-200 max-h-[300px] overflow-y-auto">
    {{ result.notes_local | safe }}
  </div>

  <h3 class="text-lg font-medium mb-2 text-white">ğŸ“ Notes in English:</h3>
  <div class="bg-neutral-900 p-4 rounded-md shadow border border-neutral-800 mb-6 text-neutral-200 max-h-[300px] overflow-y-auto">
    {{ result.notes_english | safe }}
  </div>

  <hr class="my-6 border-neutral-800">

  <!-- Quiz Prep Section -->
  <div id="quiz-prep-section" class="mb-6">
    <h3 class="text-lg font-semibold mb-2 text-white">ğŸ¤– Ready to Prepare for a Quiz?</h3>
    <form action="/prepare_quiz_decision" method="POST" class="inline-block">
      <input type="hidden" name="lecture_notes" value="{{ result.notes_english }}">
      <button class="bg-gradient-to-r from-green-700 to-green-800 hover:from-green-600 hover:to-green-700 text-white px-4 py-2 rounded-md shadow transition mr-2"
              name="decision" value="yes" type="submit">
        âœ… Yes, prepare quiz!
      </button>
    </form>
    <form action="/prepare_quiz_decision" method="POST" class="inline-block">
      <button class="bg-gradient-to-r from-red-700 to-red-800 hover:from-red-600 hover:to-red-700 text-white px-4 py-2 rounded-md shadow transition"
              name="decision" value="no" type="submit">
        âŒ No, notes are enough
      </button>
    </form>
  </div>
{% endif %}

{% if show_material_upload %}
  <div id="material-upload-section" class="mb-8">
    <h3 class="text-lg font-semibold mb-2 text-white">ğŸ“„ Do you have more relevant materials (PDFs/slides)?</h3>
    <form action="/upload_material" method="POST" enctype="multipart/form-data" class="mb-4 space-y-4">
      <label class="custom-file-upload bg-gradient-to-r from-neutral-700 to-neutral-800 hover:from-neutral-600 hover:to-neutral-700 text-white px-4 py-2 rounded-md cursor-pointer shadow transition inline-block">
        ğŸ“š Upload Material
        <input type="file" name="materials" id="materials" accept=".pdf,.ppt,.pptx,.txt" class="hidden">
      </label>
      <span id="materials-file-name" class="ml-3 text-neutral-400 italic">No file chosen</span>
      <br>
      <button class="bg-gradient-to-r from-green-700 to-green-800 hover:from-green-600 hover:to-green-700 text-white px-6 py-2 rounded-md shadow transition" type="submit">
        ğŸ“¤ Upload File
      </button>
    </form>

    <form action="/material_decision" method="POST">
      <button class="bg-gradient-to-r from-neutral-700 to-neutral-800 hover:from-neutral-600 hover:to-neutral-700 text-white px-6 py-2 rounded-md shadow transition"
              name="material_decision" value="no" type="submit">
        No, continue without more material
      </button>
    </form>
  </div>
{% endif %}

{% if show_quiz_assistant %}
  <div id="quiz-agent-launch" class="mb-8">
    <h3 class="text-lg font-semibold mb-2 text-white">ğŸ§  Launch Quiz Assistant</h3>
    <form action="/start_quiz_assistant" method="POST" class="space-y-4">
      <label for="type" class="block text-neutral-200 font-medium">Select Quiz Type:</label>
      <select name="type" id="type"
              class="w-full md:w-1/2 bg-neutral-900 border border-neutral-700 rounded-md px-4 py-2 text-neutral-200 focus:outline-none focus:ring-2 focus:ring-neutral-500">
        <option value="all">All Types</option>
        <option value="mcq">Multiple Choice</option>
        <option value="short">Short Answer</option>
        <option value="long">Long Answer</option>
      </select>
      <button class="bg-gradient-to-r from-neutral-700 to-neutral-800 hover:from-neutral-600 hover:to-neutral-700 text-white px-6 py-2 rounded-md shadow transition" type="submit">
        ğŸ“ Help Me Prepare for Quiz
      </button>
    </form>
  </div>
{% endif %}

<a href="/" class="inline-block bg-gradient-to-r from-neutral-700 to-neutral-800 hover:from-neutral-600 hover:to-neutral-700 text-white px-6 py-2 rounded-md shadow transition mt-4">
  ğŸ  Go Back Home
</a>

<script>
  const materialsInput = document.getElementById("materials");
  const fileNameDisplay = document.getElementById("materials-file-name");

  if (materialsInput) {
    materialsInput.addEventListener("change", function () {
      fileNameDisplay.textContent = this.files[0]?.name || "No file chosen";
    });
  }
</script>

{% endblock %}
